   Compiling threads_and_c v0.1.0 (/home/greg/rust-examples/threads_and_c)
error: linking with `emcc` failed: exit status: 1
  |
  = note: "emcc" "-s" "EXPORTED_FUNCTIONS=[\"_main\",\"_rust_eh_personality\"]" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.1111dzbiwa2mx0qv.rcgu.o" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.17mmhvzia8bv6ehd.rcgu.o" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.208ig7e4hpquhd4j.rcgu.o" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.24x0zjrnni4btyt0.rcgu.o" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.2hivla1b0acpijq4.rcgu.o" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.2o7or68x4fws2gni.rcgu.o" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.466dohqghlkxxl6w.rcgu.o" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.2y90kcpixii3wlf7.rcgu.o" "-L" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps" "-L" "/home/greg/rust-examples/threads_and_c/target/debug/deps" "-L" "/home/greg/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libpanic_unwind-47f7ed2622f7e5ec.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd_detect-9e409bb632defe79.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/librustc_demangle-f5724bfe84e522e9.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libhashbrown-caa40b1889c39888.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/librustc_std_workspace_alloc-50e43ae754ea25b6.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libunwind-7cba088298a00114.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libcfg_if-3b4017bf502afa4c.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/liblibc-dd0b31ff443bd762.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/liballoc-e89b25fbf415ccfb.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/librustc_std_workspace_core-41836c5a5e3c86fd.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libcore-61a23ecc4c65a94f.rlib" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libcompiler_builtins-13d20469cb2aaf55.rlib" "-l" "c" "-s" "DISABLE_EXCEPTION_CATCHING=0" "-L" "/home/greg/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib" "-L" "/home/greg/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/self-contained" "-o" "/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.js" "-O0" "--memory-init-file" "0" "-g4" "-s" "DEFAULT_LIBRARY_FUNCS_TO_INCLUDE=[]" "src/gxx_personality_v0_stub.o" "src/test.o" "-pthread" "-s" "PROXY_TO_PTHREAD" "-s" "ASYNCIFY" "-s" "ERROR_ON_UNDEFINED_SYMBOLS=1" "-s" "ASSERTIONS=1" "-s" "ABORTING_MALLOC=0" "-Wl,--fatal-warnings"
  = note: emcc: warning: please replace -g4 with -gsource-map [-Wdeprecated]
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.2.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::sys_common::thread_info::THREAD_INFO::__getit::STATE::h23a43961a5b1f8ea`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.2.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::sys_common::thread_info::THREAD_INFO::__getit::VAL::h9c9cebae0e89157a`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.2.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::sys_common::thread_info::THREAD_INFO::__getit::VAL::h9c9cebae0e89157a`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.2.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::sys_common::thread_info::THREAD_INFO::__getit::VAL::h9c9cebae0e89157a`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.2.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::sys_common::thread_info::THREAD_INFO::__getit::STATE::h23a43961a5b1f8ea`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.2.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::sys_common::thread_info::THREAD_INFO::__getit::VAL::h9c9cebae0e89157a`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.2.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::sys_common::thread_info::THREAD_INFO::__getit::STATE::h23a43961a5b1f8ea`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.2.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::sys_common::thread_info::THREAD_INFO::__getit::STATE::h23a43961a5b1f8ea`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.4.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::panicking::panic_count::LOCAL_PANIC_COUNT::__getit::__KEY::he151e7e6bd71488d`
          wasm-ld: error: /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib(std-0a6baeff0b65a514.std.38606d96-cgu.6.rcgu.o): relocation R_WASM_MEMORY_ADDR_TLS_SLEB cannot be used against non-TLS symbol `std::io::stdio::OUTPUT_CAPTURE::__getit::__KEY::h6e84e854776f0897`
          emcc: error: '/home/greg/emsdk/upstream/bin/wasm-ld -o /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.wasm /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.1111dzbiwa2mx0qv.rcgu.o /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.17mmhvzia8bv6ehd.rcgu.o /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.208ig7e4hpquhd4j.rcgu.o /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.24x0zjrnni4btyt0.rcgu.o /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.2hivla1b0acpijq4.rcgu.o /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.2o7or68x4fws2gni.rcgu.o /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.466dohqghlkxxl6w.rcgu.o /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/threads_and_c.2y90kcpixii3wlf7.rcgu.o -L/home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps -L/home/greg/rust-examples/threads_and_c/target/debug/deps -L/home/greg/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd-0a6baeff0b65a514.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libpanic_unwind-47f7ed2622f7e5ec.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libstd_detect-9e409bb632defe79.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/librustc_demangle-f5724bfe84e522e9.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libhashbrown-caa40b1889c39888.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/librustc_std_workspace_alloc-50e43ae754ea25b6.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libunwind-7cba088298a00114.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libcfg_if-3b4017bf502afa4c.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/liblibc-dd0b31ff443bd762.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/liballoc-e89b25fbf415ccfb.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/librustc_std_workspace_core-41836c5a5e3c86fd.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libcore-61a23ecc4c65a94f.rlib /home/greg/rust-examples/threads_and_c/target/wasm32-unknown-emscripten/debug/deps/libcompiler_builtins-13d20469cb2aaf55.rlib -lc-mt -L/home/greg/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib -L/home/greg/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/wasm32-unknown-emscripten/lib/self-contained src/gxx_personality_v0_stub.o src/test.o --fatal-warnings -L/home/greg/emsdk/upstream/emscripten/cache/sysroot/lib/wasm32-emscripten /home/greg/emsdk/upstream/emscripten/cache/sysroot/lib/wasm32-emscripten/crtbegin.o -lGL-mt -lal -lhtml5 -lstubs-debug -lc-mt -lcompiler_rt-mt -lc++-mt -lc++abi-mt -ldlmalloc-mt -lc_rt-mt -lsockets-mt -mllvm -combiner-global-alias-analysis=false -mllvm -enable-emscripten-cxx-exceptions -mllvm -enable-emscripten-sjlj -mllvm -disable-lsr --import-undefined --import-memory --shared-memory --export-if-defined=main --export-if-defined=rust_eh_personality --export-if-defined=emscripten_stack_get_base --export-if-defined=emscripten_stack_get_end --export-if-defined=emscripten_stack_set_limits --export-if-defined=emscripten_stack_get_free --export-if-defined=emscripten_stack_init --export-if-defined=stackSave --export-if-defined=stackRestore --export-if-defined=stackAlloc --export-if-defined=__wasm_call_ctors --export-if-defined=fflush --export-if-defined=__errno_location --export-if-defined=__emscripten_init_main_thread --export-if-defined=_emscripten_call_on_thread --export-if-defined=_emscripten_main_thread_futex --export-if-defined=_emscripten_thread_init --export-if-defined=_emscripten_thread_exit --export-if-defined=_emscripten_thread_free_data --export-if-defined=emscripten_current_thread_process_queued_calls --export-if-defined=_emscripten_allow_main_runtime_queued_calls --export-if-defined=emscripten_futex_wake --export-if-defined=emscripten_get_global_libc --export-if-defined=emscripten_main_browser_thread_id --export-if-defined=emscripten_main_thread_process_queued_calls --export-if-defined=emscripten_run_in_main_runtime_thread_js --export-if-defined=emscripten_sync_run_in_main_thread_2 --export-if-defined=emscripten_sync_run_in_main_thread_4 --export-if-defined=emscripten_tls_init --export-if-defined=pthread_self --export-if-defined=pthread_testcancel --export-if-defined=exit --export-if-defined=memalign --export-if-defined=emscripten_proxy_main --export-if-defined=malloc --export-if-defined=free --export-if-defined=__cxa_is_pointer_type --export-if-defined=__cxa_can_catch --export-if-defined=setThrew --export-if-defined=ntohs --export-if-defined=htons --export-if-defined=htonl --export-if-defined=__start_em_asm --export-if-defined=__stop_em_asm --export-table -z stack-size=5242880 --initial-memory=16777216 --no-entry --max-memory=16777216 --global-base=1024' failed (returned 1)
          

error: could not compile `threads_and_c` due to previous error
